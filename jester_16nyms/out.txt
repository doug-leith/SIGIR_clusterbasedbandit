Retrieving R from files... Got users... Got ratings... Got movies... Got R.
Removing columns...Removing rows...R Density: 0.56338, ratings: 4136360, users: 73421, items: 100, features: 20, nyms: 1
Splitting dataset with test_ratio=0.1
Removed 0 rows from test_R due to too few training samples.
Training Density: 0.50704, ratings: 3722724, users: 73421, items: 100, features: 20, nyms: 1
Pre-processing time: 0.709

Running weighted alternating least squares? True

[<pyopencl.Platform 'NVIDIA CUDA' at 0x23b6580>]
[<pyopencl.Device 'GeForce RTX 2080 Ti' on 'NVIDIA CUDA' at 0x23b83a0>]
Itt/Users/Chng		Timings (Rtilde, P, Alsqr V)	Iter	Delta
 0 /      10 /      10	  0.000 /   0.001 /   0.325	5	1.51e-02
 0 /     100 /     100	  0.000 /   0.000 /   0.385	5	1.82e-03
 0 /    1000 /    1000	  0.000 /   0.000 /   0.113	1	5.46e-05
 0 /   10000 /   10000	  0.000 /   0.003 /   0.133	1	6.23e-07
 0 /   73421 /   73421	  0.000 /   0.030 /   0.143	1	1.15e-08
--- Nym distribution (MSE/rating): 73421 (25.477), Total error: 25.477.
Main-loop time: 1.532

--> Splitting 1 nym(s) (distances: 1), increasing to 2. 73421 (100%) users affected. (Rtilde density: 1.000)
 0 /      20 /      11	  0.000 /   0.002 /   0.409	5	3.46e-01
 0 /     200 /      68	  0.000 /   0.001 /   0.415	5	2.88e-01
 0 /    2000 /     572	  0.000 /   0.002 /   0.340	5	7.32e-02
 0 /   20000 /    5309	  0.001 /   0.008 /   0.101	1	4.01e-04
 0 /   73421 /   20574	  0.004 /   0.063 /   0.131	1	1.66e-05
 1 /   73421 /    5785	  0.006 /   0.031 /   0.128	1	1.39e-05
 2 /   73421 /    3904	  0.006 /   0.026 /   0.129	1	1.36e-05
 3 /   73421 /    2608	  0.006 /   0.026 /   0.128	1	1.42e-05
 4 /   73421 /    1782	  0.028 /   0.054 /   0.131	1	1.47e-05
 5 /   73421 /    1258	  0.026 /   0.048 /   0.134	1	1.52e-05
 6 /   73421 /     841	  0.024 /   0.047 /   0.134	1	1.55e-05
 7 /   73421 /     549	  0.007 /   0.033 /   0.138	1	1.56e-05
--- Nym distribution (MSE/rating): 36130 (23.233), 37291 (19.037), Total error: 21.025.
Main-loop time: 3.856

--> Splitting 2 nym(s) (distances: 5, 5), increasing to 4. 73421 (100%) users affected. (Rtilde density: 1.000)
 0 /      40 /      20	  0.000 /   0.001 /   0.383	5	3.16e-01
 0 /     400 /      95	  0.000 /   0.002 /   0.324	5	2.11e-01
 0 /    4000 /     908	  0.001 /   0.003 /   0.393	5	1.59e-01
 0 /   40000 /   12818	  0.002 /   0.014 /   0.399	5	7.45e-02
 0 /   73421 /   25789	  0.002 /   0.015 /   0.088	1	5.25e-04
 1 /   73421 /    6994	  0.009 /   0.068 /   0.106	1	4.06e-04
 2 /   73421 /    4210	  0.010 /   0.052 /   0.121	1	3.87e-04
 3 /   73421 /    3285	  0.006 /   0.038 /   0.119	1	4.42e-04
 4 /   73421 /    2583	  0.014 /   0.043 /   0.132	1	5.69e-04
 5 /   73421 /    2202	  0.018 /   0.048 /   0.178	2	3.94e-02
 6 /   73421 /    1907	  0.006 /   0.071 /   0.298	5	7.35e-02
 7 /   73421 /    1526	  0.006 /   0.052 /   0.305	5	9.65e-02
 8 /   73421 /    1206	  0.034 /   0.071 /   0.377	5	8.60e-02
 9 /   73421 /    1006	  0.034 /   0.071 /   0.306	5	6.87e-02
--- Nym distribution (MSE/rating): 12234 (22.693), 23870 (17.992), 26392 (20.175), 10925 (15.449), Total error: 19.073.
Main-loop time: 5.976

--> Splitting 4 nym(s) (distances: 3, 3, 3, 4), increasing to 8. 73421 (100%) users affected. (Rtilde density: 1.000)
 0 /      80 /      34	  0.000 /   0.002 /   0.423	5	2.65e-01
 0 /     800 /     144	  0.000 /   0.002 /   0.331	5	1.44e-01
 0 /    8000 /    1562	  0.001 /   0.004 /   0.331	5	1.33e-01
 0 /   73421 /   18890	  0.047 /   0.069 /   0.310	5	2.61e-02
 1 /   73421 /    8819	  0.041 /   0.074 /   0.334	5	2.59e-02
 2 /   73421 /    6359	  0.029 /   0.070 /   0.305	5	3.04e-02
 3 /   73421 /    4780	  0.036 /   0.073 /   0.273	5	3.17e-02
 4 /   73421 /    3855	  0.035 /   0.071 /   0.297	5	3.07e-02
 5 /   73421 /    3265	  0.009 /   0.037 /   0.286	5	3.17e-02
 6 /   73421 /    2744	  0.028 /   0.071 /   0.281	5	3.74e-02
 7 /   73421 /    2276	  0.029 /   0.072 /   0.288	5	4.18e-02
 8 /   73421 /    1958	  0.039 /   0.071 /   0.302	5	4.37e-02
 9 /   73421 /    1720	  0.034 /   0.070 /   0.344	5	4.25e-02
--- Nym distribution (MSE/rating): 5018 (19.411), 12741 (15.717), 12204 (16.198), 8559 (14.642), 10041 (20.868), 7384 (20.064), 9048 (20.809), 8426 (19.478), Total error: 18.001.
Main-loop time: 7.159

--> Splitting 8 nym(s) (distances: 7, 13, 167, 30, 7, 37, 13, 23), increasing to 16. 73421 (100%) users affected. (Rtilde density: 1.000)
 0 /     160 /      89	  0.000 /   0.002 /   0.382	5	3.55e-01
 0 /    1600 /     377	  0.000 /   0.002 /   0.285	5	2.12e-01
 0 /   16000 /    3297	  0.001 /   0.008 /   0.308	5	2.01e-01
 0 /   73421 /   18058	  0.018 /   0.072 /   0.266	5	1.26e-01
 1 /   73421 /    9851	  0.013 /   0.076 /   0.293	5	1.23e-01
 2 /   73421 /    6350	  0.037 /   0.079 /   0.275	5	8.17e-02
 3 /   73421 /    4680	  0.032 /   0.077 /   0.289	5	6.21e-02
 4 /   73421 /    3848	  0.031 /   0.072 /   0.263	5	5.56e-02
 5 /   73421 /    3385	  0.007 /   0.042 /   0.260	5	5.12e-02
 6 /   73421 /    3147	  0.030 /   0.069 /   0.251	5	4.75e-02
 7 /   73421 /    2728	  0.007 /   0.031 /   0.280	5	4.25e-02
 8 /   73421 /    2447	  0.028 /   0.060 /   0.269	5	3.83e-02
 9 /   73421 /    2159	  0.037 /   0.078 /   0.279	5	3.61e-02
--- Nym distribution (MSE/rating): 4360 (19.143), 5515 (15.237), 7530 (14.411), 5630 (14.073), 4776 (20.410), 5875 (15.475), 5535 (19.056), 4715 (19.399), 2331 (15.938), 4628 (15.380), 5310 (17.199), 2915 (11.616), 4117 (20.112), 1934 (24.944), 4018 (21.062), 4232 (18.458), Total error: 17.169.
Main-loop time: 7.440

Doubling stopped. Running last pass.
 0 /   73421 /    1960	  0.007 /   0.026 /   0.341	5	3.48e-02
 1 /   73421 /    1809	  0.032 /   0.079 /   0.274	5	3.37e-02
 2 /   73421 /    1627	  0.025 /   0.074 /   0.267	5	3.10e-02
 3 /   73421 /    1555	  0.028 /   0.077 /   0.245	5	2.86e-02
 4 /   73421 /    1489	  0.027 /   0.068 /   0.251	5	2.73e-02
 5 /   73421 /    1358	  0.010 /   0.042 /   0.263	5	2.56e-02
 6 /   73421 /    1329	  0.038 /   0.075 /   0.280	5	2.38e-02
 7 /   73421 /    1297	  0.029 /   0.075 /   0.256	5	2.28e-02
 8 /   73421 /    1203	  0.029 /   0.071 /   0.250	5	2.24e-02
 9 /   73421 /    1168	  0.007 /   0.041 /   0.237	5	2.24e-02
--- Nym distribution (MSE/rating): 4279 (18.859), 5363 (15.927), 8020 (13.931), 5593 (13.996), 4188 (21.015), 5837 (15.073), 5062 (18.938), 4541 (19.627), 2829 (16.831), 4797 (15.256), 5156 (18.405), 3325 (11.946), 4156 (20.224), 2047 (24.168), 3967 (20.935), 4261 (18.092), Total error: 17.131.
Main-loop time: 5.560

Maximum number of nyms of 16 reached without reaching error tolerance (0.010).
Total time taken: 31.805

Factorisation RMSE: 4.138961
Prediction RMSE: 4.323616
