Retrieving R from files... Got users... Got ratings... Got movies... Got R.
Removing columns...Removing rows...R Density: 0.56338, ratings: 4136360, users: 73421, items: 100, features: 20, nyms: 1
Splitting dataset with test_ratio=0.1
Removed 0 rows from test_R due to too few training samples.
Training Density: 0.50704, ratings: 3722724, users: 73421, items: 100, features: 20, nyms: 1
Pre-processing time: 0.719

Running weighted alternating least squares? True

[<pyopencl.Platform 'NVIDIA CUDA' at 0x17b78c0>]
[<pyopencl.Device 'GeForce RTX 2080 Ti' on 'NVIDIA CUDA' at 0x15a16b0>]
Itt/Users/Chng		Timings (Rtilde, P, Alsqr V)	Iter	Delta
 0 /      10 /      10	  0.000 /   0.001 /   0.307	5	2.70e-02
 0 /     100 /     100	  0.000 /   0.000 /   0.347	5	2.97e-03
 0 /    1000 /    1000	  0.000 /   0.000 /   0.136	1	1.21e-04
 0 /   10000 /   10000	  0.000 /   0.003 /   0.135	1	1.41e-06
 0 /   73421 /   73421	  0.000 /   0.042 /   0.138	1	2.61e-08
--- Nym distribution (MSE/rating): 73421 (25.473), Total error: 25.473.
Main-loop time: 1.510

--> Splitting 1 nym(s) (distances: 1), increasing to 2. 73421 (100%) users affected. (Rtilde density: 1.000)
 0 /      20 /       6	  0.000 /   0.002 /   0.456	5	3.06e-01
 0 /     200 /      40	  0.000 /   0.001 /   0.323	5	3.16e-01
 0 /    2000 /     501	  0.000 /   0.002 /   0.366	5	1.45e-01
 0 /   20000 /    4988	  0.001 /   0.008 /   0.388	5	1.89e-02
 0 /   73421 /   18666	  0.022 /   0.047 /   0.141	1	1.23e-04
 1 /   73421 /    4708	  0.006 /   0.042 /   0.135	1	8.53e-05
 2 /   73421 /    3429	  0.006 /   0.026 /   0.130	1	6.83e-05
 3 /   73421 /    2420	  0.006 /   0.037 /   0.124	1	5.91e-05
 4 /   73421 /    1681	  0.006 /   0.036 /   0.131	1	5.30e-05
 5 /   73421 /    1237	  0.006 /   0.027 /   0.129	1	4.99e-05
 6 /   73421 /     856	  0.006 /   0.026 /   0.122	1	4.81e-05
 7 /   73421 /     593	  0.006 /   0.026 /   0.126	1	4.72e-05
--- Nym distribution (MSE/rating): 39847 (19.294), 33574 (23.249), Total error: 21.022.
Main-loop time: 4.155

--> Splitting 2 nym(s) (distances: 3, 3), increasing to 4. 73421 (100%) users affected. (Rtilde density: 1.000)
 0 /      40 /      20	  0.000 /   0.001 /   0.379	5	1.92e-01
 0 /     400 /      58	  0.000 /   0.002 /   0.384	5	1.89e-01
 0 /    4000 /     554	  0.001 /   0.003 /   0.378	5	1.47e-01
 0 /   40000 /    6559	  0.003 /   0.014 /   0.382	5	3.89e-02
 0 /   73421 /   14538	  0.002 /   0.023 /   0.360	5	2.41e-02
 1 /   73421 /    8284	  0.030 /   0.072 /   0.370	5	3.68e-02
 2 /   73421 /    3778	  0.006 /   0.052 /   0.325	5	1.98e-01
 3 /   73421 /    1946	  0.009 /   0.035 /   0.346	5	2.12e-01
 4 /   73421 /     920	  0.020 /   0.070 /   0.401	5	1.30e-01
 5 /   73421 /     530	  0.025 /   0.073 /   0.466	5	8.91e-02
--- Nym distribution (MSE/rating): 25570 (18.146), 25310 (20.562), 12081 (15.723), 10460 (22.165), Total error: 19.057.
Main-loop time: 5.754

--> Splitting 4 nym(s) (distances: 11, 2, 40, 2), increasing to 8. 73421 (100%) users affected. (Rtilde density: 1.000)
 0 /      80 /      43	  0.000 /   0.002 /   0.340	5	3.63e-01
 0 /     800 /     161	  0.000 /   0.002 /   0.295	5	1.82e-01
 0 /    8000 /    1577	  0.001 /   0.004 /   0.317	5	1.29e-01
 0 /   73421 /   18875	  0.038 /   0.073 /   0.293	5	1.21e-01
 1 /   73421 /    9326	  0.033 /   0.074 /   0.291	5	1.41e-01
 2 /   73421 /    5897	  0.023 /   0.075 /   0.285	5	8.95e-02
 3 /   73421 /    4479	  0.029 /   0.071 /   0.306	5	6.37e-02
 4 /   73421 /    3556	  0.043 /   0.070 /   0.328	5	5.26e-02
 5 /   73421 /    2926	  0.026 /   0.071 /   0.311	5	4.13e-02
 6 /   73421 /    2388	  0.037 /   0.072 /   0.336	5	3.35e-02
 7 /   73421 /    1915	  0.008 /   0.069 /   0.253	5	2.94e-02
 8 /   73421 /    1598	  0.034 /   0.064 /   0.314	5	2.58e-02
 9 /   73421 /    1399	  0.036 /   0.070 /   0.337	5	2.29e-02
--- Nym distribution (MSE/rating): 11690 (16.031), 10914 (20.497), 8427 (14.365), 9623 (21.168), 8422 (17.263), 11826 (18.093), 8356 (18.496), 4163 (18.808), Total error: 18.001.
Main-loop time: 7.113

Doubling stopped. Running last pass.
 0 /   73421 /    1189	  0.006 /   0.024 /   0.362	5	2.12e-02
 1 /   73421 /    1075	  0.043 /   0.073 /   0.324	5	2.03e-02
 2 /   73421 /     999	  0.024 /   0.075 /   0.326	5	1.95e-02
 3 /   73421 /     938	  0.023 /   0.073 /   0.078	1	9.77e-04
 4 /   73421 /     916	  0.006 /   0.076 /   0.069	1	9.73e-04
 5 /   73421 /     970	  0.034 /   0.068 /   0.112	1	9.60e-04
 6 /   73421 /    1001	  0.034 /   0.065 /   0.075	1	8.99e-04
 7 /   73421 /    1037	  0.047 /   0.073 /   0.109	1	8.68e-04
 8 /   73421 /    1041	  0.006 /   0.076 /   0.140	1	8.24e-04
 9 /   73421 /    1074	  0.031 /   0.059 /   0.103	1	7.64e-04
--- Nym distribution (MSE/rating): 10858 (15.842), 10029 (20.404), 8206 (14.323), 9678 (20.853), 9205 (17.571), 11507 (18.275), 9186 (18.056), 4752 (19.470), Total error: 17.975.
Main-loop time: 4.132

Maximum number of nyms of 8 reached without reaching error tolerance (0.010).
Total time taken: 22.934

Factorisation RMSE: 4.239639
Prediction RMSE: 4.379852
